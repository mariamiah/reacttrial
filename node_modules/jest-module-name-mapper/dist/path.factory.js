"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chalk_1 = require("chalk");
const base_url_factory_1 = require("./base-url.factory");
const config_factory_1 = require("./config.factory");
const keyFactory = (key) => `^${key.replace(/\*/, '(.*)')}`;
const valueFactory = (values, baseUrl) => `${baseUrl}/${values[0].replace(/\*/, '$1')}`;
const connectPath = (path, baseUrl) => ({
    [keyFactory(path[0])]: valueFactory(path[1], baseUrl)
});
const convertToJestFormat = (result, item) => (Object.assign({}, result, item));
const pathFactory = (paths, baseUrl) => Object
    .entries(paths)
    .map(item => connectPath(item, baseUrl))
    .reduce(convertToJestFormat, {});
exports.moduleNameMapper = (path) => {
    const config = config_factory_1.getConfig(path);
    const { compilerOptions: { paths, baseUrl } } = config;
    if (!paths || !baseUrl) {
        console.error(chalk_1.default.red('[tsconfig.json] "paths" or "baseUrl" field does not exist'));
        process.exit();
    }
    const transformedBaseUrl = base_url_factory_1.baseUrlFactory(baseUrl);
    return pathFactory(paths, transformedBaseUrl);
};
//# sourceMappingURL=path.factory.js.map